{"ast":null,"code":"import { makeAutoObservable, runInAction } from 'mobx';\nimport agent from '../api/agent';\nimport { v4 as uuid } from 'uuid';\nexport default class ActivityStore {\n  constructor() {\n    this.activities = [];\n    this.activityRegistry = new Map();\n    this.selectedActivity = undefined;\n    this.editMode = false;\n    this.loading = false;\n    this.loadingInitial = false;\n\n    this.loadActivities = async () => {\n      //el codigo asincrono se ejecuta fuera del bloque trycatch\n      this.setLoadingInitial(true);\n\n      try {\n        //codigo asincrono sera dentro del bloqye trycatch\n        const activities = await agent.Activities.list();\n        activities.forEach(activity => {\n          activity.date = activity.date.split('T')[0];\n          this.activityRegistry.set(activity.id, activity);\n        });\n        this.setLoadingInitial(false);\n      } catch (error) {\n        console.log(error);\n        this.setLoadingInitial(false);\n      }\n    };\n\n    this.getActivity = async id => {//return this.activities.get(id);\n    };\n\n    this.setLoadingInitial = state => {\n      this.loadingInitial = state;\n    };\n\n    this.selectActivity = id => {\n      this.selectedActivity = this.activities.find(a => a.id === id);\n    };\n\n    this.cancelSelectedActivity = () => {\n      this.selectedActivity = undefined;\n    };\n\n    this.openForm = id => {\n      id ? this.selectActivity(id) : this.cancelSelectedActivity();\n      this.editMode = true;\n    };\n\n    this.closeForm = () => {\n      this.editMode = false;\n    };\n\n    this.createActivity = async activity => {\n      this.loading = true;\n      activity.id = uuid();\n\n      try {\n        await agent.Activities.create(activity);\n        runInAction(() => {\n          this.activities.push(activity);\n          this.selectedActivity = activity;\n          this.editMode = false;\n          this.loading = false;\n        });\n      } catch (error) {\n        console.log(error);\n        runInAction(() => {\n          this.loading = false;\n        });\n      }\n    };\n\n    this.updateActivity = async activity => {\n      this.loading = true;\n\n      try {\n        await agent.Activities.update(activity);\n        runInAction(() => {\n          this.activities = [...this.activities.filter(a => a.id !== activity.id), activity];\n          this.selectedActivity = activity;\n          this.editMode = false;\n          this.loading = false;\n        });\n      } catch (error) {\n        console.log(error);\n        runInAction(() => {\n          this.loading = false;\n        });\n      }\n    };\n\n    this.deleteActivity = async id => {\n      this.loading = true;\n\n      try {\n        await agent.Activities.delete(id);\n        runInAction(() => {\n          var _this$selectedActivit;\n\n          this.activities = [...this.activities.filter(a => a.id !== id)];\n\n          if (((_this$selectedActivit = this.selectedActivity) === null || _this$selectedActivit === void 0 ? void 0 : _this$selectedActivit.id) === id) {\n            this.cancelSelectedActivity();\n          }\n\n          this.loading = false;\n        });\n      } catch (error) {\n        console.log(error);\n        runInAction(() => {\n          this.loading = false;\n        });\n      }\n    };\n\n    makeAutoObservable(this);\n  }\n\n}","map":{"version":3,"sources":["/home/gm/Downloads/reactivities/frontend/src/app/stores/activityStore.ts"],"names":["makeAutoObservable","runInAction","agent","v4","uuid","ActivityStore","constructor","activities","activityRegistry","Map","selectedActivity","undefined","editMode","loading","loadingInitial","loadActivities","setLoadingInitial","Activities","list","forEach","activity","date","split","set","id","error","console","log","getActivity","state","selectActivity","find","a","cancelSelectedActivity","openForm","closeForm","createActivity","create","push","updateActivity","update","filter","deleteActivity","delete"],"mappings":"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","sourcesContent":["import { makeAutoObservable, runInAction } from 'mobx';\nimport agent from '../api/agent';\nimport { Activity } from '../models/Activity';\nimport { v4 as uuid } from 'uuid';\n\nexport default class ActivityStore {\n\tactivities: Activity[] = [];\n\tactivityRegistry = new Map<string,Activity>();\n\tselectedActivity: Activity | undefined = undefined;\n\teditMode = false;\n\tloading = false;\n\tloadingInitial = false;\n\n\tconstructor() {\n\t\tmakeAutoObservable(this);\n\t}\n\n\tloadActivities = async () => {\n\t\t//el codigo asincrono se ejecuta fuera del bloque trycatch\n\t\tthis.setLoadingInitial(true);\n\t\ttry {\n\t\t\t//codigo asincrono sera dentro del bloqye trycatch\n\t\t\tconst activities = await agent.Activities.list();\n\n\t\t\tactivities.forEach((activity) => {\n\t\t\t\tactivity.date = activity.date.split('T')[0];\n\t\t\t\tthis.activityRegistry.set(activity.id,activity);\n\t\t\t});\n\t\t\tthis.setLoadingInitial(false);\n\t\t} catch (error) {\n\t\t\tconsole.log(error);\n\t\t\tthis.setLoadingInitial(false);\n\t\t}\n\t};\n\n\tprivate getActivity = async (id:string) => {\n\t\t//return this.activities.get(id);\n\t}\n\n\tsetLoadingInitial = (state: boolean) => {\n\t\tthis.loadingInitial = state;\n\t};\n\n\tselectActivity = (id: string) => {\n\t\tthis.selectedActivity = this.activities.find((a) => a.id === id);\n\t};\n\n\tcancelSelectedActivity = () => {\n\t\tthis.selectedActivity = undefined;\n\t};\n\n\topenForm = (id?: string) => {\n\t\tid ? this.selectActivity(id) : this.cancelSelectedActivity();\n\t\tthis.editMode = true;\n\t};\n\n\tcloseForm = () => {\n\t\tthis.editMode = false;\n\t};\n\n\tcreateActivity = async (activity: Activity) => {\n\t\tthis.loading = true;\n\t\tactivity.id = uuid();\n\t\ttry {\n\t\t\tawait agent.Activities.create(activity);\n\t\t\trunInAction(() => {\n\t\t\t\tthis.activities.push(activity);\n\t\t\t\tthis.selectedActivity = activity;\n\t\t\t\tthis.editMode = false;\n\t\t\t\tthis.loading = false;\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tconsole.log(error);\n\t\t\trunInAction(() => {\n\t\t\t\tthis.loading = false;\n\t\t\t});\n\t\t}\n\t};\n\n\tupdateActivity = async (activity: Activity) => {\n\t\tthis.loading = true;\n\t\ttry {\n\t\t\tawait agent.Activities.update(activity);\n\t\t\trunInAction(() => {\n\t\t\t\tthis.activities = [ ...this.activities.filter((a) => a.id !== activity.id), activity ];\n\t\t\t\tthis.selectedActivity = activity;\n\t\t\t\tthis.editMode = false;\n\t\t\t\tthis.loading = false;\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tconsole.log(error);\n\t\t\trunInAction(() => {\n\t\t\t\tthis.loading = false;\n\t\t\t});\n\t\t}\n\t};\n\n\tdeleteActivity = async (id: string) => {\n\t\tthis.loading = true;\n\t\ttry {\n\t\t\tawait agent.Activities.delete(id);\n\t\t\trunInAction(() => {\n\t\t\t\tthis.activities = [ ...this.activities.filter((a) => a.id !== id) ];\n\t\t\t\tif (this.selectedActivity?.id === id) {\n\t\t\t\t\tthis.cancelSelectedActivity();\n\t\t\t\t}\n\t\t\t\tthis.loading = false;\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tconsole.log(error);\n\t\t\trunInAction(() => {\n\t\t\t\tthis.loading = false;\n\t\t\t});\n\t\t}\n\t};\n}\n"]},"metadata":{},"sourceType":"module"}